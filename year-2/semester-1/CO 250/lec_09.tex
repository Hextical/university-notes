\section{2019-10-03}
\begin{remark}
    The following lecture will not be 1-1 since the explanations in class were useless.
\end{remark}

\subsection{Example (Continuation of 8.3)}
So, the new basic feasible solution is $\bm{\bar{x}}:=(1,5,0,3,0)^\top$
determined by the basis $B:=\{1,2,5\}\cup\{4\}\setminus \{5\}=\{1,2,4\}$. Note that
we exclude $\{5\}$ since the index of which $t$ achieved the minimum was at
$\nicefrac{6}{2}$, i.e. index $5$ (row $x_5$). The canonical form determined by the new
basis is
\[\max \begin{bmatrix}
    0 & 0 & -\nicefrac{5}{2} & 0 & -\nicefrac{1}{2}
\end{bmatrix}\bm{x}+3\]
subject to
\[
    \begin{bmatrix}
        1 & 0 & \nicefrac{1}{2} & 0 & -\nicefrac{1}{2}\\
        0 & 1 & \nicefrac{1}{2} & 0 & \nicefrac{1}{2}\\
        0 & 0 & -\nicefrac{3}{2} & 1 & \nicefrac{1}{2}
    \end{bmatrix}\bm{x}
    =
    \begin{bmatrix}
        1\\
        5\\
        3
    \end{bmatrix}
\]
\begin{remark}
    $\bm{\bar{x}}$ is the optimal solution with optimal value $3$.
\end{remark}
\begin{remark}
    How did we arrive to this LP? Using the formulae in Proposition 8.2. If you didn't want to
    calculate $A_B^{-1}$, then follow the below instructions.
\end{remark}

\subsection{Example (Canonical form without computing the inverse)}
\begin{remark}
    The following was not taught in class or the textbook. 
    This method can be confusing and not intuitive.
\end{remark}


Write
\[A:=
    \left[\begin{array}{ccccc|c}  
        1 & 0 & -1 & 1 & 0 & 4\\
        0 & 1 & 2 & -1 & 0 & 2\\
        0 & 0 & -3 & 2 & 1 & 6
       \end{array}\right]
    \rightarrow
    \left[\begin{array}{ccccc|c}
        1 & 0 & \nicefrac{1}{2} & 0 & -\nicefrac{1}{2} & 1\\
        0 & 1 & \nicefrac{1}{2} & 0 & \nicefrac{1}{2} & 5\\
        0 & 0 & -\nicefrac{3}{2} & 1 & \nicefrac{1}{2} & 3
    \end{array}\right]
    \begin{matrix}
        -x_1\\
        -x_2\\
        -x_4
    \end{matrix}
\]
and row reduce $A$ to make fourth column get a leading one as seen above.
The row-reduced matrix and the augment are your new constraints.\\
The objective function is tricky, we want a 0 in the fourth column of our $\bm{c}^\top $.
Also, we denote $x_1,x_2,x_4$ as the rows of the matrix respectively as seen above.
Using $x_4$ (which is our row-reduced $A$), we get
\[(-1)\left(
    \begin{bmatrix}
        0 & 0 & -\nicefrac{3}{2} & 1 & \nicefrac{1}{2}
    \end{bmatrix}\bm{x}-3\right)+
    (\begin{bmatrix}
        0 & 0 & -4 & 1 & 0
    \end{bmatrix}\bm{x})
\]
The $-3$ right after the first matrix was the row of $\bm{b}$. General form:
\[ c([\text{Row}_i(A)]\bm{x}-\bm{b_i})+\text{original objective function} \]
where $ c $ is a constant.

\subsection{Simplex Algorithm}
\begin{algorithm}
    \caption{Simplex Algorithm}
    \SetKwInOut{Input}{Input}
    \SetKwInOut{Output}{Output}
    \Input{$A\in \mathbb{R}^{m\times n}$, $\bm{b}\in\mathbb{R}^m$, $\bm{c}\in\mathbb{R}^n$}
    Compute the canonical form for $B$, let $\bm{\bar{x}}$ 
    be the basic feasible solution for $ B $.\\
    If $\bm{c_N}\le \bm{0}$, then stop ($\bm{\bar{x}}$ is optimal).\\
    Choose $k\in N$ such that $c_k>0$.\\
    If $\bm{a_k}\le \bm{0}$, then stop (the LP is unbounded).\\
    Let $r$ be any index $ i $ which attains $t=\min\{\nicefrac{b_i}{a_{ik}} : a_{ik}>0\}$.\\
    Let $l\in B$ be the $r^{th}$ basis element.\\
    Set $B:=B\cup\{k\}\setminus\{l\}$.\\
    Go to step 1.
\end{algorithm}

\begin{thmbox}
    \subsection{Bland's Rule}
    In step 3, among all $k\in N$, with $c_k>0$ and in step 5, $l\in B$, 
    choose the smallest index for both $k$ and $r$.
\end{thmbox}

\subsection{Example (Simplex Algorithm with Bland's Rule)}
(P)
\[ \max
\begin{bmatrix}
    0 & 3 & 1 & 0
\end{bmatrix}\bm{x} \]
subject to
\[ 
\begin{bmatrix}
    1 & 2 & -2 & 0\\
    0 & 1 & 3 & 1
\end{bmatrix}\bm{x}=
\begin{bmatrix}
    2\\
    5
\end{bmatrix} \]
\[ \bm{x}\ge \bm{0} \]
\underline{Iteration 1}

1. The LP is already in canonical form determined by $ B=\{1,4\} $.
Let $ \bm{\bar{x}}:=(2,0,0,5)^\top $ be the basic feasible solution.

2. $ c_{\{2,3\}} \nleq \bm{0} $, so $ \bm{\bar{x}} $ is not optimal.

3. Using Bland's Rule we choose $ 2\in N $ as $ c_2\ge 0 $.

4.
$ 
A_2= \begin{bmatrix}
    2\\
    1
\end{bmatrix}\nleq \bm{0}
$,
so the LP is not unbounded.

5.
$
\begin{bmatrix}
    x_1\\
    x_4
\end{bmatrix}
=
\begin{bmatrix}
    2\\
    5
\end{bmatrix}-
\begin{bmatrix}
    2\\
    1
\end{bmatrix}\ge 0
$
so
\[ t=\min \left\{\frac{2}{2},\frac{5}{1} \right\} \]
Thus, we let $ r=1 $ be the index which attains the smallest value of $ t $.

6. Let $ 1\in B $ be a basis element.

7. Set $ B:=\{1,4\}\cup \{2\}\setminus\{1\}=\{2,4\} $

\underline{Iteration 2}

1. Canonical form determined by $ B=\{2,4\} $ is
\[ \max 
\begin{bmatrix}
    -\nicefrac{3}{2} & 0 & 4 & 0
\end{bmatrix} + 3\]
subject to
\[ 
\begin{bmatrix}
    \nicefrac{1}{2} & 1 & -1 & 0\\
    -\nicefrac{1}{2} & 0 & 4 & 1
\end{bmatrix}\bm{x}=
\begin{bmatrix}
    1\\
    4
\end{bmatrix}
\]
Useful values computed:
\[ A_B=
\begin{bmatrix}
    2 & 0\\
    1 & 1\\
\end{bmatrix} \Rightarrow
A_B^{-1}=
\begin{bmatrix}
    \nicefrac{1}{2} & 0\\
    -\nicefrac{1}{2} & 1\\
\end{bmatrix} \]
\[ \bm{y}^\top=\bm{c_B}^\top A_B^{-1}=
\begin{bmatrix}
    3 & 0
\end{bmatrix}
\begin{bmatrix}
    \nicefrac{1}{2} & 0\\
    -\nicefrac{1}{2} & 1\\
\end{bmatrix}=
\begin{bmatrix}
    \nicefrac{3}{2} \\
    0
\end{bmatrix}\]

Let $ \bm{\bar{x}}:=(0,1,0,4)^\top $ be the basic feasible solution.

2. $ c_{\{1,3\}} \nleq \bm{0} $, so $ \bm{\bar{x}} $ is not optimal.

3. Using Bland's Rule we choose $ 3\in N $ as $ c_3\ge 0 $.

4.
$ 
A_3= \begin{bmatrix}
    -1\\
    4
\end{bmatrix}\nleq \bm{0}
$,
so the LP is not unbounded.

5.
$
\begin{bmatrix}
    x_2\\
    x_4
\end{bmatrix}
=
\begin{bmatrix}
    1\\
    4
\end{bmatrix}-
\begin{bmatrix}
    -1\\
    4
\end{bmatrix}\ge 0
$
so
\[ t=\min \left\{\_,\frac{4}{4} \right\} \]
Thus, we let $ r=4 $ be the index which attains the smallest value of $ t $.

6. Let $ 4\in B $ be a basis element.

7. Set $ B:=\{1,4\}\cup \{3\}\setminus\{4\}=\{2,3\} $

\underline{Iteration 3}

1. Canonical form determined by $ B=\{2,3\} $ is
\[ \max
\begin{bmatrix}
    -1 & 0 & 0 & -1
\end{bmatrix} + 7\]

subject to
\[ 
\begin{bmatrix}
    \nicefrac{3}{8} & 1 & 0 & \nicefrac{1}{4} \\
    -\nicefrac{1}{8} & 0 & 1 & \nicefrac{1}{4}
\end{bmatrix}\bm{x}=
\begin{bmatrix}
    2\\
    1
\end{bmatrix}\]
Useful values computed:
\[ A_B=
\begin{bmatrix}
    1 & -1\\
    0 & 4\\
\end{bmatrix} \Rightarrow
A_B^{-1}=
\begin{bmatrix}
    1 & \nicefrac{1}{4} \\
    0 & \nicefrac{1}{4} 
\end{bmatrix} \]
\[ \bm{y}^\top=\bm{c_B}^\top A_B^{-1}=
\begin{bmatrix}
    0 & 4
\end{bmatrix}
\begin{bmatrix}
    1 & \nicefrac{1}{4} \\
    0 & \nicefrac{1}{4} 
\end{bmatrix}=
\begin{bmatrix}
    0 & 1
\end{bmatrix}\]
Let $ \bm{\bar{x}}:=(0,2,1,0)^\top $ be the basic feasible solution.

2. $ c_{\{1,4\}}\le \bm{0} $, stop $ \bm{\bar{x}} $ is optimal.

The certificate of optimality is $ \bm{y}=(0,1)^\top $.

\begin{remark}
    This was obviously not done in class (in fact it's a textbook question!).
    It can be verified that $ \bm{y} $ is indeed the certificate of optimality by
    using the summary of outcomes.
\end{remark}